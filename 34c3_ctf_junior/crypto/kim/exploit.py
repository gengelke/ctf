import hlextend



sha = hlextend.new('sha1')



# Given an existing sha1 hash value '52e98441017043eee154a6d1af98c5e0efab055c', known data of 'hello', an unknown secret of length 10 and data you wish to append of 'file', you would do the following to perform the attack:





# mac('f=dont.gif')   = 'ae3d232d2bec408b79b68ba6a57cf05399060509'

# msg = 'f=dont.gif'



# mac('f=sample.gif') = '952bb2a215b032abe27d24296be099dc3334755c'

# msg = 'f=sample.gif'



base = 'http://35.198.133.163:1337/files/'



for l in range(4,16):

#    ext = sha.extend('&f=flag', 'f=sample.gif', l, '952bb2a215b032abe27d24296be099dc3334755c')

    ext = sha.extend('&f=flag', 'f=dont.gif', l, 'ae3d232d2bec408b79b68ba6a57cf05399060509')

    fdir = sha.hexdigest()

    print(base + fdir + '/?' + ext)



    # c60fa7de0860d4048a3bfb36b70299a95e6587c9
